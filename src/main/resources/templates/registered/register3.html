<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>验证成功</title>
    <link rel="stylesheet" type="text/css" href="/css/register/register4.css"/>
    <link rel="stylesheet" type="text/css" href="/layui/layui.css"/>
</head>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<body>
<div class="main">
    <header>&nbsp;
        <ul>
            <br/>
            <br/>
            <br/>
            <li>
                <span class="current-num">1</span>
                <span class="current">验证邮箱</span>
            </li>
            <img class="icon-arrow" src="/image/arrow.png" />
            <li class="current2">
                <span class="current-num">2</span>
                <span class="current">填写用户名和密码</span>
            </li>
            <img class="icon-arrow" src="/image/arrow.png" />
            <li class="c">
                <span class="current-num">3</span>
                <span class="current">验证成功</span>
            </li>
        </ul>
    </header>
    <div class="success">
            <form action="home" method="post">
      <!--          <input type="hidden" name="password" th:value="${password}"/>
                <input type="hidden" name="token" th:value="${token}"/>
                <input type="hidden" name="username" th:value="${phone}"/>-->
                <span class="text" th:text="注册成功，请录入面部信息">，注册成功！</span>
                <br/>
                <div class="recognize-face">
                    <!--<video id="video" width="500" height="400" autoplay></video>-->
                    <div class="allow-wrapper">
                        <img src="/image/allow-face.png">
                        <button class="allow-face-info" type="button">录入面部信息</button>
                    </div>
                    <!--<canvas id="canvas" width="500" height="400"></canvas>-->
                </div>
                <input type="submit" class="next" value="立即登录！" id="next"/>
            </form>
    </div>
</div>
</body>
<script>
    $(function () {
        $("body").keydown(function () {
            if (event.keyCode == "13") {//keyCode=13是回车键
                $('.next').click();
            }
        });
        $(".allow-face-info").click(function () {
            $(".filter").hide();
        });
    });
</script>
<script type="text/javascript">
    // var context = canvas.getContext("2d");
    //当DOM树构建完成的时候就会执行DOMContentLoaded事件
    window.addEventListener("DOMContentLoaded", function() {
        // //获得Canvas对象
        // var canvas = document.getElementById("canvas");
        //获得video摄像头区域
        var video = document.getElementById("video");
        var videoObj = {
            "video" : true
        };
        var errBack = function(error) {
            console.log("Video capture error: ", error.code);
        }

        /*           //获得摄像头并显示到video区域
                   if (navigator.getUserMedia) { // Standard
       alert(111)
                       navigator.getUserMedia(videoObj, function(stream) {
       console.log(stream)
                           video.srcObject = stream;
                       }, errBack);
                   } else if (navigator.webkitGetUserMedia) { // WebKit-prefixed
       alert(22)
                       navigator.webkitGetUserMedia(videoObj, function(stream) {
                           video.src = window.webkitURL.createObjectURL(stream);
                       }, errBack);
                   } else if (navigator.mozGetUserMedia) { // Firefox-prefixed
       alert(33)
              navigator.mediaDevices.getUserMedia(videoObj, function(stream) {
                           video.src = window.URL.createObjectURL(stream);
                       }, errBack);
       video.play();
       */

        navigator.mediaDevices.getUserMedia({  video: true })
            .then(function(stream) {
                // 旧的浏览器可能没有srcObject
                if ("srcObject" in video) {
                    video.srcObject = stream;
                } else {
                    // 防止再新的浏览器里使用它，应为它已经不再支持了
                    video.src = window.URL.createObjectURL(stream);
                }
                video.onloadedmetadata = function(e) {
                    video.play();
                };
            })
            .catch(function(err) {
                console.log(err.name + ": " + err.message);
            });
    }, false);
    // // 触发拍照动作
    // document.getElementById("snap").addEventListener("click", function() {
    //     context.drawImage(video, 0, 0, 500, 400);
    //     var imgData = canvas.toDataURL();
    //     var imgData1 = imgData.substring(22);
    //     console.log(imgData)
    //     console.log(imgData1)
    // });
</script>
</html>
